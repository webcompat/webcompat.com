{% extends "layout.html" %}
{% block body %}
  <div class="IssueList js-issue-page" data-username="{{ session.username }}">
  {% include "shared/nav.html" %}
    <div class="wc-content wc-content--body js-issuelist-filter">
      <script type="text/template" id="issuelist-filter-tmpl">
      <!-- Temporary Header -->
      <h2 class="wc-margin-bottom">Issues</h2>
      <div class="Dropdown Dropdown--large js-dropdown-wrapper"></div>
      <div>
        <button type="button" class="IssueList-filtering IssueList-filtering--untriaged" data-filter="untriaged">
          <span class="IssueList-filtering-count"></span> Untriaged</span>
        </button>
        <button type="button" class="IssueList-filtering IssueList-filtering--need" data-filter="needsdiagnosis">
          <span class="IssueList-filtering-count"></span> Needs Diagnosis</span>
        </button>
        <button type="button" class="IssueList-filtering IssueList-filtering--ready" data-filter="contactready">
          <span class="IssueList-filtering-count"></span> Ready for outreach</span>
        </button>
        <button type="button" class="IssueList-filtering IssueList-filtering--sitewait" data-filter="sitewait">
          <span class="IssueList-filtering-count"></span> Site contacted</span>
        </button>
        <button type="button" class="IssueList-filtering IssueList-filtering--close" data-filter="closed">
          <span class="IssueList-filtering-count"></span> Closed</span>
        </button>
      </div>
      </script>
    </div>
    {% if session.user_id and session.avatar_url %}
    <div class="IssueList-search js-issuelist-search">
      <script type="text/template" id="issuelist-search-tmpl">
      <div class="wc-content IssueList-search-content">
        <input type="text" class="IssueList-search-form mousetrap" placeholder="Search by keyword">
        <button role="button" type="submit" class="r-ResetButton IssueList-search-button js-search-button"><span class="icon icon-search"></span></button>
      </div>
      </script>
    </div>
    {% endif %}
    <div class="IssueList-sorting">
      <div class="wc-content">
        <div class="Grid">
          <div class="Grid-cell u-size1of2 u-sm-sizeFull">
            <div class="js-issue-sorting">
              <script type="text/template" id="issuelist-sorting-tmpl">
                <div class="Dropdown wc-inline-block js-dropdown-wrapper js-dropdown-pagination"></div>
                <div class="Dropdown wc-inline-block js-dropdown-wrapper js-dropdown-sort"></div>
              </script>
            </div>
          </div>
          <div class="Grid-cell u-size1of2 u-sm-sizeFull IssueList-pagination js-pagination-controls">
            <button class="r-ResetButton IssueList-pagination-link js-pagination-previous" href="#">previous</button>
            <button class="r-ResetButton IssueList-pagination-link js-pagination-next" href="#">next</button>
          </div>
        </div>
      </div>
    </div>
    <div class="IssueList-displayed">
      <div class="wc-content js-issue-list">
        <script type="text/template" id="issuelist-issue-tmpl">
        <% if (issues.length) { %>
          <% _.each(issues, function(issue) { %>
          <div class="IssueItem IssueItem--<%= issue.stateClass %> IssueItem--large u-table">
            <div class="IssueItem-section">
              <p class="IssueItem-header">
                <a href="/issues/<%= issue.number %>"><span class="IssueItem-count">Issue <%= issue.number %></span>: <%- issue.title %></a>
              </p>
              <p>
                <span class="IssueItem-metadata">Opened: <time><%= issue.createdAt %></time></span>
                <span class="IssueItem-metadata">Comments: <%= issue.commentNumber %></span>
              </p>
            </div>
            <div class="IssueItem-section">
              <span class="IssueItem-label"><% _.each(issue.labels, function(label) { %>
                <a href="#" class="wc-bold"><%= label.name %></a>
              <% }); %></span>
            </div>
          </div>
          <% }); %>
        <% } else { %>
          <p class="IssueList-noResultat">
              <span class="icon icon-search"></span>
              <span class="u-block">No results found.</span>
          </p>
        <% } %>
        </script>
      </div>
    </div>
  </div>

<script type="text/template" id="dropdown-tmpl">
<button type="button" class="Dropdown-toggle js-dropdown-toggle">
   <span class="Dropdown-label"><%= dropdownTitle %></span> <span class="icon icon-chevron-down"></span>
</button>
<ul class="Dropdown-content js-dropdown-options" aria-hidden="false">
  <% _.each(dropdownOptions, function(option) { %>
  <li class="Dropdown-item">
    <a href="#" class="Dropdown-link" data-params="<%= option.params %>"><%= option.title %></a>
  </li>
  <% }); %>
</ul>
</script>

{% endblock %}
{% block extrascripts %}
{%- if config.PRODUCTION or config.DEVELOPMENT -%}
<script src="{{ url_for('static', filename='js/issue-list.min.js') }}"></script>
{% else %}
<script src="{{ url_for('static', filename='js/lib/models/issue.js') }}"></script>
<script src="{{ url_for('static', filename='js/lib/issue-list.js') }}"></script>
{%- endif %}
{% endblock %}
